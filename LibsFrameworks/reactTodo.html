<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Personal CSS -->
    <link rel="stylesheet" href="./CSS/todo.css" />

    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>

    <title>Todo App</title>
  </head>
  <body>
    <p>
      <a href="http://carlosgreenpersonalsite.com" target="_blank">
        Back to the homepage
      </a>
    </p>

    <div style="color:black" id="root"></div>

    <script type="text/babel">
      const Todos = ({todos, deleteTodo}) => {
        const todoList = todos.length ? (
          todos.map((todo, index) => {
            return (
              <h4 className="collection-item" key={todo.id}>
                <span
                  onClick={() => {
                    deleteTodo(todo.id);
                  }}>
                  {index + 1}: {todo.content}
                </span>
              </h4>
            );
          })
        ) : (
          <p className="center">You have nothing left todo!</p>
        );
        return <div className="todos collection">{todoList}</div>;
      };

      class AddTodo extends React.Component {
        constructor(props) {
          super(props);
          (this.state = {
            content: '',
          }),
            (this.handleChange = e => {
              this.setState({
                content: e.target.value,
              });
            }),
            (this.handleSubmit = e => {
              e.preventDefault();
              this.props.addTodo(this.state);
            });
        }

        render() {
          return (
            <div>
              <form onSubmit={this.handleSubmit}>
                <label>Add Todo:</label>
                <br />
                <input
                  type="text"
                  onChange={this.handleChange}
                  value={this.state.content}
                />
              </form>
            </div>
          );
        }
      }

      class App extends React.Component {
        constructor(props) {
          super(props);
          (this.state = {
            todos: [
              {id: 1, content: 'Buy Milk'},
              {id: 2, content: 'Buy Cheese'},
              {id: 3, content: 'Buy Eggs'},
              {id: 4, content: 'Learn React'},
            ],
          }),
            (this.deleteTodo = id => {
              const todos = this.state.todos.filter(todo => {
                return todo.id !== id;
              });
              this.setState({
                todos,
              });
            });
          this.addTodo = todo => {
            todo.id = Math.random();
            let todos = [...this.state.todos, todo];
            this.setState({
              todos,
            });
          };
        }

        render() {
          return (
            <div className="todo-app container">
              <h1 className="center">React Todo List</h1>
              <p>Click a todo to delete it</p>
              <AddTodo addTodo={this.addTodo} />
              <Todos
                todos={this.state.todos}
                deleteTodo={this.deleteTodo}
                createTodo={this.createTodo}
              />
            </div>
          );
        }
      }

      ReactDOM.render(<App />, document.getElementById('root'));
    </script>
  </body>
</html>
