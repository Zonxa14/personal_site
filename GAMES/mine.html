<!DOCTYPE html>
<html lang="en">
  <head>
    <title>step3.html</title>

    <style>
    body {
      font-family: 'Inconsolata', monospace;
      text-align: center;
    }

    .container {
      display: inline-block;
    }

    .row {
      height: 50px;
      width: 50px;
      border: 1px solid black;
      background-color: aqua;
    }

    .col {
      display: inline-block;
      width: 50px;
      height: 50px;
      border-right: 2px solid black;
      border-bottom: 2px solid black;
      vertical-align: top;
      color: block;
      font-size: 20px;
      line-height: 50px;
      transition: all 1s;
    }

    .row.hidden {
      background-color: aqua;
      cursor: pointer;
    }

    .row.hidden:hover {
      background-color: lightgray;
    }

    .row:last-child .col {
        border-right: none;
      }
    </style>
  </head>
  <body>
    <p>
      <a href="http://carlosgreenpersonalsite.com">
        Back to the homepage
      </a>
    </p>

    <h1>Minesweeper!</h1>
    <div class="container"></div>

    <script>
      const container = document.querySelector('.container');

      var Minesweeper = function(row, col) {
        this.board = [];
        this.createBoard(row, col);
      };

      Minesweeper.prototype.createBoard = function(rows, cols) {
        container.innerHTML = '';
        for (let i = 0; i < cols; i++) {
          const col = document.createElement('div');
          col.classList.add('col');
          for (let j = 0; j < rows; j++) {
            this.board.push(new Box(i, j, col));
          }
          container.append(col);
        }
      };
/*
Write a function that returns the array of neighbors
when you click on a non-bomb box,
then display the number of bombs around that box.
*/

      function Neighbors(row, col) {
        const box = document.querySelector(
          `[data-row="${row}"][data-col="${col}"]`,
        );
        if (box.classList.contains('mine')) return;
        box.style.backgroundColor = 'grey';
        return [
          document.querySelector(`[data-row="${row - 1}"][data-col="${col}"]`),
          document.querySelector(`[data-row="${row + 1}"][data-col="${col}"]`),
          document.querySelector(`[data-row="${row}"][data-col="${col - 1}"]`),
          document.querySelector(`[data-row="${row}"][data-col="${col + 1}"]`),
        ];
      }

      function Box(row, col, column) {
        const box = document.createElement('div');
        box.classList.add('row');
        box.classList.add('hidden');
        box.setAttribute('data-row', row);
        box.setAttribute('data-col', col);
        if (Math.random() < 0.1) {
          box.classList.add('mine');
        }

        box.addEventListener('click', () => {
          if (box.classList.contains('mine')) {
            console.log('stepped on a mine game over!');
          } else {
            const adj = Neighbors(row, col);
            console.log();
            console.log(adj, 'adj');
            let count = 0;
            adj.forEach(e => {
              if (e === null) {
                count += 0;
              } else if (e.classList.contains('mine')) {
                count += 1;
              }
            });
            if (count > 0) {
              box.innerHTML = count;
            }
          }
        });
        column.append(box);
      }

      const tenByTen = new Minesweeper(10, 10);
      console.log(tenByTen.board, 'board');
    </script>
  </body>
</html>
